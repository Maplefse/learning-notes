# Git

### 版本控制

版本控制是一种在开发的过程中用于管理文件,目录或工程等内容的修改历史,方便查看更改历史记录,备份以便恢复以前版本的软件工程技术。

- 实现跨区域多人协同开发
- 追踪和记载一个或者多个文档的历史记录
- 组织和保护源代码
- 统计工作量
- 并行开发，提高开发效率
- 跟踪记录整个软件的开发过程

简单的说：就是用于管理多人协同开发项目的技术。

在日常使用的情况下，常常会发现我们进行修改后的并不是很满意，需要回退到以前的版本。版本控制就可以轻松的实现回退功能



#### 主流的版本控制器有以下几种

- Git
- SVN（Subversion）
- CVS（Concurrent Versions System）
- VSS（Micorosoft Visual SourceSafe）
- TFS（Team Foundation Server）
- Visual Studio Online

#### 版本控制分类

##### 1、本地版本控制

记录文件每次的更新，可以对每个版本做一个快照，或是记录补丁。

<img src="C:\Users\13717\Desktop\QQ截图20210419102659.png" alt="QQ截图20210419102659" style="zoom:50%;" />.

##### 2、集中版本控制

将所有的版本保存在服务器上，协同开发者从服务器上同步或更新上传自己的修改

<img src="C:\Users\13717\Desktop\QQ截图20210419102829.png" alt="QQ截图20210419102829" style="zoom: 50%;" />

所有的版本数据都存在服务器上，用户的本地只有自己以前同步的版本，如果不联网的话，用户就看不到历史版本，也无法切换版本验证问题。或在不同分支工作。若是服务器出现问题，就有数据损坏的风险。（一般定期保存数据在本地）

##### 3、分布式版本控制系统

每个人都拥有全部的代码（有安全隐患）

所有版本信息仓库全部同步到本地的每个用户，这样就可以在本地查看所有的历史版本，可以离线追踪本地提交，只需要在连网时push到相应的服务器或是 其它用户那里。由于每个用户那里保存的都是所有的版本数据，只要有一个用户的设备没有问题就可以恢复所有的数据。但这增加了本地存储空间的占用

<img src="assets\image-20210419104453997.png" alt="image-20210419104453997" style="zoom:50%;" />

Git与SVN的主要区别

SVN是集中式版本控制系统，版本库是集中放在中央服务器的，而工作的时候用的都是自己的电脑。所以要首先从中央服务器获取最新的版本，然后工作，完成工作后，需要把自己做完的内容推送到中央服务器集中式版本控制系统必须联网才能工作，对网络带宽需求较高

Git是分布式版本控制系统，没有中央服务器，每个不同的设备就是一个完整的版本库，工作的时候就不需要联网，因为版本都在自己的电脑上。不同设备更改文件后，只需要将各自的修改推送给对方，就可以互相看到对方的修改了，Git可以直接看到更新了哪些代码和文件

### Git环境配置

#### Git下载

打开git官网 https://git-scm.com/ ,下载对应操作系统的版本

下载速度慢的话可以找淘宝镜像下载

http://npm.taobao.org/mirrors/git-for-windows/

安装无脑选择下一步

安装成功后在开始菜单中会有Git项，菜单下有3个程序：

**Git Bash：**Unix与Linux风格的命令行，使用最多，推荐最多

**Git CMD：**Windows风格的命令行

**Git GUI**：图形界面的Git，不建议初学者使用，尽量先熟悉常用命令



### 常用的Linux命令

1）、cd : 改变目录。

2）、cd . . 回退到上一个目录，直接cd进入默认目录

3）、pwd : 显示当前所在的目录路径。

4）、ls(ll):  都是列出当前目录中的所有文件，只不过ll(两个ll)列出的内容更为详细。

5）、touch : 新建一个文件 如 touch index.js 就会在当前目录下新建一个index.js文件。

6）、rm:  删除一个文件, rm index.js 就会把index.js文件删除。

7）、mkdir:  新建一个目录,就是新建一个文件夹。

8）、rm -r :  删除一个文件夹, rm -r src 删除src目录

```
rm -rf / 切勿在Linux中尝试！删除电脑中全部文件！
```

9）、mv 移动文件, mv index.html src index.html 是我们要移动的文件, src 是目标文件夹,当然, 这样写,必须保证文件和目标文件夹在同一目录下。

10）、reset 重新初始化终端/清屏。

11）、clear 清屏。

12）、history 查看命令历史。

13）、help 帮助。

14）、exit 退出。

15）、#表示注释

### Git配置

所有的配置文件，其实都保存在本地！

查看配置 git config -l

查看不同级别的配置文件：

```
#查看系统configgit config --system --list　　
#查看当前用户（global）配置git config --global  --list
```

**Git相关的配置文件：**

1）、Git\etc\gitconfig  ：Git 安装目录下的 gitconfig   --system 系统级

2）、C:\Users\Administrator\ .gitconfig   只适用于当前登录用户的配置  --global 全局

#### 设置用户名与邮箱（用户标识，必要）

当你安装Git后首先要做的事情是设置你的用户名称和e-mail地址。这是非常重要的，因为每次Git提交都会使用该信息。它被永远的嵌入到了你的提交中：

```cmd
git config --global user.name "kuangshen"  #名称
git config --global user.email 24736743@qq.com   #邮箱
```

只需要做一次这个设置，如果你传递了--global 选项，因为Git将总是会使用该信息来处理你在系统中所做的一切操作。如果你希望在一个特定的项目中使用不同的名称或e-mail地址，你可以在该项目中运行该命令而不要--global选项。总之--global为全局配置，不加为某个项目的特定配置。

### Git基本理论

Git本地有三个工作区域：工作目录（Working Directory）、暂存区(Stage/Index)、资源库(Repository或Git Directory)。如果在加上远程的git仓库(Remote Directory)就可以分为四个工作区域。文件在这四个区域之间的转换关系如下：

![640](C:\Users\13717\Desktop\640.jpg)

- Directory：使用Git管理的一个目录，也就是一个仓库，包含我们的工作空间和Git的管理空间。
- WorkSpace：需要通过Git进行版本控制的目录和文件，这些目录和文件组成了工作空间。
- .git：存放Git管理信息的目录，初始化仓库的时候自动创建。
- Index/Stage：暂存区，或者叫待提交更新区，在提交进入repo之前，我们可以把所有的更新放在暂存区。
- Local Repo：本地仓库，一个存放在本地的版本库；HEAD会只是当前的开发分支（branch）。
- Stash：隐藏，是一个工作状态保存栈，用于保存/恢复WorkSpace中的临时状态。

git的工作流程一般是这样的：

１、在工作目录中添加、修改文件；

２、将需要进行版本管理的文件放入暂存区域；

３、将暂存区域的文件提交到git仓库。

因此，git管理的文件有三种状态：已修改（modified）,已暂存（staged）,已提交(committed)

### Git项目搭建

创建本地仓库的方法有两种：一种是创建全新的仓库，另一种是克隆远程仓库。

1、创建全新的仓库，需要用GIT管理的项目的根目录执行：

```git
# 在当前目录新建一个Git代码库
$ git init
```

2、执行后可以看到，仅仅在项目目录多出了一个.git目录，关于版本等的所有信息都在这个目录里面。

1、另一种方式是克隆远程目录，由于是将远程服务器上的仓库完全镜像一份至本地！

```git
# 克隆一个项目和它的整个代码历史(版本信息)
$ git clone [url]  # https://gitee.com/kuangstudy/openclass.git
```

### Git文件操作

git文件的状态

版本控制就是对文件的版本控制，要对文件进行修改、提交等操作，首先要知道文件当前在什么状态，不然可能会提交了现在还不想提交的文件，或者要提交的文件没提交上。

- Untracked: 未跟踪, 此文件在文件夹中, 但并没有加入到git库, 不参与版本控制. 通过git add 状态变为Staged.
- Unmodify: 文件已经入库, 未修改, 即版本库中的文件快照内容与文件夹中完全一致. 这种类型的文件有两种去处, 如果它被修改, 而变为Modified. 如果使用git rm移出版本库, 则成为Untracked文件
- Modified: 文件已修改, 仅仅是修改, 并没有进行其他的操作. 这个文件也有两个去处, 通过git add可进入暂存staged状态, 使用git checkout 则丢弃修改过, 返回到unmodify状态, 这个git checkout即从库中取出文件, 覆盖当前修改 !
- Staged: 暂存状态. 执行git commit则将修改同步到库中, 这时库中的文件和本地文件又变为一致, 文件为Unmodify状态. 执行git reset HEAD filename取消暂存, 文件状态为Modified

```git
#查看指定文件状态
git status [filename]

#查看所有文件状态
git status

# git add .                  添加所有文件到暂存区
# git commit -m "消息内容"    提交暂存区中的内容到本地仓库 -m 提交信息
```

#### 忽略文件

有些时候我们不想把某些文件纳入版本控制中，比如数据库文件，临时文件，设计文件等

在主目录下建立".gitignore"文件，此文件有如下规则：

1. 忽略文件中的空行或以井号（#）开始的行将会被忽略。
2. 可以使用Linux通配符。例如：星号（*）代表任意多个字符，问号（？）代表一个字符，方括号（[abc]）代表可选字符范围，大括号（{string1,string2,...}）代表可选的字符串等。
3. 如果名称的最前面有一个感叹号（!），表示例外规则，将不被忽略。
4. 如果名称的最前面是一个路径分隔符（/），表示要忽略的文件在此目录下，而子目录中的文件不忽略。
5. 如果名称的最后面是一个路径分隔符（/），表示要忽略的是此目录下该名称的子目录，而非文件（默认文件或目录都忽略）。

```git
#为注释
*.txt        #忽略所有 .txt结尾的文件,这样的话上传就不会被选中！
!lib.txt     #但lib.txt除外
/temp        #仅忽略项目根目录下的TODO文件,不包括其它目录temp
build/       #忽略build/目录下的所有文件
doc/*.txt    #会忽略 doc/notes.txt 但不包括 doc/server/arch.txt
```

